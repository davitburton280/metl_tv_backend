(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"55j5":function(e,s,i){"use strict";i.r(s),i.d(s,"ChannelsModule",(function(){return q}));var n=i("ofXK"),c=i("tyNb"),t=i("9xOu"),a=i("3Pt+"),r=i("fXoL"),o=i("FFj9"),b=i("Rnal"),u=i("tk/3");let h=(()=>{class e{constructor(e){this.httpClient=e}changeProfileImage(e){return this.httpClient.post(t.b+"users/change-profile-image",e)}changeCoverImage(e){return this.httpClient.post(t.b+"users/change-cover-image",e)}getUserInfo(e){return this.httpClient.get(t.b+"users/get-user-info",{params:e})}}return e.\u0275fac=function(s){return new(s||e)(r.fc(u.b))},e.\u0275prov=r.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=i("1m4N"),d=i("HHsJ"),f=i("wDcp"),g=i("hKYS"),p=i("kUS0"),m=i("bhfF");function v(e,s){if(1&e){const e=r.Yb();r.Xb(0,"div",23),r.Xb(1,"input",24),r.jc("change",(function(s){return r.Gc(e),r.nc(2).coverChangeEvent(s)})),r.Wb(),r.Xb(2,"ngx-photo-editor",25),r.jc("imageCropped",(function(s){return r.Gc(e),r.nc(2).coverCropped(s)})),r.Wb(),r.Wb()}if(2&e){const e=r.nc(2);r.sc("hidden",!0),r.Cb(2),r.sc("imageChanedEvent",e.coverChangedEvent)("autoCrop",!1)("viewMode",3)}}function C(e,s){if(1&e&&r.Sb(0,"img",26),2&e){const e=r.nc(2);r.sc("src",e.apiUrl+"uploads/avatars/"+e.channelUser.avatar,r.Ic)}}function U(e,s){1&e&&r.Sb(0,"img",27),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function I(e,s){if(1&e){const e=r.Yb();r.Xb(0,"div",23),r.Xb(1,"input",28),r.jc("change",(function(s){return r.Gc(e),r.nc(2).profileChangeEvent(s)})),r.Wb(),r.Xb(2,"ngx-photo-editor",29),r.jc("imageCropped",(function(s){return r.Gc(e),r.nc(2).profileCropped(s)})),r.Wb(),r.Wb()}if(2&e){const e=r.nc(2);r.sc("hidden",!0),r.Cb(2),r.sc("imageChanedEvent",e.profileChangedEvent)("aspectRatio",4/3)("viewMode",1)("resizeToWidth",500)}}function W(e,s){if(1&e){const e=r.Yb();r.Xb(0,"a",33),r.jc("click",(function(){r.Gc(e);const s=r.nc(3);return s.subscribeToChannel(s.channelUser.channel)})),r.Pc(1,"Subscribe"),r.Wb()}}function X(e,s){if(1&e){const e=r.Yb();r.Xb(0,"a",34),r.jc("click",(function(){r.Gc(e);const s=r.nc(3);return s.subscribeToChannel(s.channelUser.channel)})),r.Pc(1,"Subscribed"),r.Wb()}}function S(e,s){if(1&e&&(r.Xb(0,"div",8),r.Sb(1,"i",30),r.Nc(2,W,2,0,"a",31),r.Nc(3,X,2,0,"a",32),r.Wb()),2&e){const e=r.nc(2);r.Cb(2),r.sc("ngIf",!e.subscribedToChannel),r.Cb(1),r.sc("ngIf",e.subscribedToChannel)}}function w(e,s){if(1&e){const e=r.Yb();r.Xb(0,"li",35),r.Xb(1,"a",36),r.jc("click",(function(){r.Gc(e);const i=s.$implicit;return r.nc(2).changeActiveTab(i)})),r.Pc(2),r.Wb(),r.Wb()}if(2&e){const e=s.$implicit,i=r.nc(2);r.Cb(1),r.Hb("active",e===i.activeTab),r.uc("id","",e.link,"-tab"),r.uc("href","#",e.link,"",r.Ic),r.Cb(1),r.Qc(e.name)}}function k(e,s){if(1&e&&r.Sb(0,"img",48),2&e){const e=r.nc(2).$implicit,s=r.nc(5);r.sc("src",s.apiUrl+"uploads/thumbnails/"+e.thumbnail,r.Ic)}}function N(e,s){1&e&&r.Sb(0,"img",48),2&e&&r.sc("src","assets/img/video-thumbnail-default.png",r.Ic)}function V(e,s){1&e&&(r.Xb(0,"span",49),r.Pc(1,"Live now"),r.Wb())}function P(e,s){if(1&e&&r.Sb(0,"img",50),2&e){const e=r.nc(4).$implicit,s=r.nc(3);r.sc("src",s.apiUrl+"uploads/avatars/"+e.avatar,r.Ic)}}function T(e,s){1&e&&r.Sb(0,"img",50),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function _(e,s){if(1&e){const e=r.Yb();r.Xb(0,"div",41),r.jc("click",(function(){r.Gc(e);const s=r.nc().$implicit,i=r.nc(2).$implicit;return r.nc(3).openVideoPage(s,i.username)})),r.Nc(1,k,1,1,"img",42),r.Nc(2,N,1,1,"img",42),r.Nc(3,V,2,0,"span",43),r.Xb(4,"div",44),r.Nc(5,P,1,1,"img",45),r.Nc(6,T,1,1,"img",45),r.Xb(7,"div"),r.Xb(8,"p",12),r.Pc(9),r.Wb(),r.Xb(10,"p",46),r.Pc(11),r.Wb(),r.Xb(12,"p",47),r.Pc(13,"17k watching"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){const e=r.nc().$implicit,s=r.nc(2).$implicit;r.Cb(1),r.sc("ngIf",e.thumbnail),r.Cb(1),r.sc("ngIf",!e.thumbnail),r.Cb(1),r.sc("ngIf","live"===e.status),r.Cb(2),r.sc("ngIf",s.avatar),r.Cb(1),r.sc("ngIf",!s.avatar),r.Cb(3),r.Qc(e.name),r.Cb(2),r.Qc(s.full_name)}}function j(e,s){1&e&&(r.Vb(0),r.Nc(1,_,14,7,"ng-template",40),r.Ub())}function y(e,s){if(1&e&&(r.Vb(0),r.Xb(1,"p",38),r.Pc(2),r.Wb(),r.Xb(3,"owl-carousel-o",39),r.Nc(4,j,2,0,"ng-container",37),r.Wb(),r.Ub()),2&e){const e=r.nc().$implicit,s=r.nc(3);r.Cb(2),r.Qc(e.full_name),r.Cb(1),r.sc("options",s.owlOptions),r.Cb(1),r.sc("ngForOf",e.videos)}}function F(e,s){if(1&e&&(r.Vb(0),r.Nc(1,y,5,3,"ng-container",1),r.Ub()),2&e){const e=s.$implicit;r.Cb(1),r.sc("ngIf",e.videos.length>0)}}function O(e,s){if(1&e&&(r.Vb(0),r.Nc(1,F,2,1,"ng-container",37),r.Ub()),2&e){const e=r.nc(2);r.Cb(1),r.sc("ngForOf",e.watchlistVideos)}}function $(e,s){1&e&&r.Sb(0,"img",52)}function R(e,s){if(1&e&&r.Sb(0,"img",48),2&e){const e=r.nc(2).$implicit,s=r.nc(3);r.tc("src",s.apiUrl+"uploads/thumbnails/"+e.thumbnail,r.Ic)}}function E(e,s){if(1&e&&r.Sb(0,"img",50),2&e){const e=r.nc(5);r.sc("src",e.apiUrl+"uploads/avatars/"+e.authUser.avatar,r.Ic)}}function G(e,s){1&e&&r.Sb(0,"img",50),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function x(e,s){if(1&e){const e=r.Yb();r.Xb(0,"div",41),r.jc("click",(function(){r.Gc(e);const s=r.nc().$implicit,i=r.nc(3);return i.openVideoPage(s,i.authUser.username)})),r.Nc(1,$,1,0,"img",51),r.Nc(2,R,1,1,"img",42),r.Xb(3,"div",44),r.Nc(4,E,1,1,"img",45),r.Nc(5,G,1,1,"img",45),r.Xb(6,"div"),r.Xb(7,"p",12),r.Pc(8),r.Wb(),r.Xb(9,"p",46),r.Pc(10),r.Wb(),r.Xb(11,"p",47),r.Pc(12,"17k watching"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){const e=r.nc().$implicit,s=r.nc(3);r.Cb(1),r.sc("ngIf",!e.thumbnail||"undefined"===e.thumbnail),r.Cb(1),r.sc("ngIf",e.thumbnail&&"undefined"!==e.thumbnail),r.Cb(2),r.sc("ngIf",s.authUser.avatar),r.Cb(1),r.sc("ngIf",!s.authUser.avatar),r.Cb(3),r.Qc(e.name),r.Cb(2),r.Qc(s.authUser.full_name)}}function A(e,s){1&e&&(r.Vb(0),r.Nc(1,x,13,6,"ng-template",40),r.Ub())}function Y(e,s){if(1&e&&(r.Vb(0),r.Xb(1,"p",38),r.Pc(2,"Recent videos"),r.Wb(),r.Xb(3,"owl-carousel-o"),r.Nc(4,A,2,0,"ng-container",37),r.Wb(),r.Ub()),2&e){const e=r.nc(2);r.Cb(4),r.sc("ngForOf",e.currentUser.videos)}}function M(e,s){if(1&e){const e=r.Yb();r.Vb(0),r.Xb(1,"div",3),r.Nc(2,v,3,4,"div",4),r.Xb(3,"label",5),r.Sb(4,"img",6),r.Wb(),r.Wb(),r.Xb(5,"div",7),r.Xb(6,"div",8),r.Xb(7,"label",9),r.Nc(8,C,1,1,"img",10),r.Nc(9,U,1,1,"img",11),r.Wb(),r.Nc(10,I,3,5,"div",4),r.Xb(11,"div"),r.Xb(12,"p",12),r.Pc(13),r.Wb(),r.Xb(14,"p",13),r.Pc(15),r.Wb(),r.Wb(),r.Wb(),r.Nc(16,S,4,2,"div",14),r.Wb(),r.Xb(17,"div",15),r.Xb(18,"div",16),r.Xb(19,"ul",17),r.Nc(20,w,3,5,"li",18),r.Wb(),r.Xb(21,"form",19),r.Xb(22,"div",20),r.Xb(23,"input",21),r.jc("keyup.enter",(function(){return r.Gc(e),r.nc().searchVideos()})),r.Wb(),r.Sb(24,"i",22),r.Wb(),r.Wb(),r.Wb(),r.Nc(25,O,2,1,"ng-container",1),r.Nc(26,Y,5,1,"ng-container",1),r.Wb(),r.Ub()}if(2&e){const e=r.nc();r.Cb(2),r.sc("ngIf",e.channelUser.username===e.authUser.username),r.Cb(2),r.sc("src",e.channelUser.cover?e.apiUrl+"uploads/covers/"+e.channelUser.cover:"assets/img/default-thumbnail.png",r.Ic),r.Cb(4),r.sc("ngIf",e.channelUser.avatar),r.Cb(1),r.sc("ngIf",!e.channelUser.avatar),r.Cb(1),r.sc("ngIf",e.channelUser.username===e.authUser.username),r.Cb(3),r.Qc(e.channelUser.channel.name),r.Cb(2),r.Rc("",e.subscribersCount+" subscriber"+(1===e.subscribersCount?"":"s")," "),r.Cb(1),r.sc("ngIf",e.channelUser.username!==e.authUser.username),r.Cb(4),r.sc("ngForOf",e.allTabs),r.Cb(1),r.sc("formGroup",e.searchVideosForm),r.Cb(4),r.sc("ngIf","Watchlist"===e.activeTab.name),r.Cb(1),r.sc("ngIf","Videos"===e.activeTab.name)}}function Q(e,s){1&e&&(r.Xb(0,"div",53),r.Xb(1,"p"),r.Pc(2,"Channel with such name is not found"),r.Wb(),r.Wb())}const B=[{path:"show",component:(()=>{class e{constructor(e,s,i,n,c,r,o,b,u){this.videoService=e,this.getAuthUser=s,this.router=i,this.usersService=n,this.base64ToFile=c,this.route=r,this.fb=o,this.channelService=b,this.subject=u,this.owlOptions=t.e,this.watchlistVideos=[],this.activeTab=t.f[0],this.allTabs=t.f,this.apiUrl=t.b,this.subscribedToChannel=!1,this.authUser=this.getAuthUser.transform(),this.passedUsername=this.route.snapshot.queryParams.username,this.searchVideosForm=this.fb.group({search:["",a.t.required]})}ngOnInit(){this.passedUsername&&this.usersService.getUserInfo({username:this.passedUsername}).subscribe(e=>{this.channelUser=e,this.checkChannelSubscription(),console.log(this.channelUser.username,this.authUser.username)}),this.videoService.getUserVideos({user_id:this.authUser.id}).subscribe(e=>{this.currentUser=e}),this.videoService.getVideosByAuthor({}).subscribe(e=>{this.watchlistVideos=e})}changeActiveTab(e){this.activeTab=e,this.searchVideos()}checkChannelSubscription(){console.log(this.channelUser),this.channelService.checkChannelSubscription({user_id:this.authUser.id,channel_id:this.channelUser.channel.id}).subscribe(e=>{this.subscribedToChannel="Subscribed"===e.status,this.subscribersCount=e.subscribers_count})}openVideoPage(e,s){let i,n;console.log(s),"live"===e.status?(i="user/video/watch",n={session:e.session_name,publisher:s}):(i="videos/play",n={id:e.id}),this.router.navigate([i],{queryParams:n})}coverChangeEvent(e){this.coverChangedEvent=e}profileChangeEvent(e){this.profileChangedEvent=e}profileCropped(e){this.profileBase64=e.base64;const s=`profile_${Date.now()}.jpg`,i=new FormData;i.append("avatar_file",this.base64ToFile.transform(e.base64),s),i.append("avatar",s),i.append("id",this.authUser.id),this.usersService.changeProfileImage(i).subscribe(e=>{localStorage.setItem("token",e.token),this.authUser=this.getAuthUser.transform(),this.channelUser=this.authUser})}coverCropped(e){this.coverBase64=e.base64;const s=new FormData,i=`cover_${Date.now()}.jpg`;s.append("cover_file",this.base64ToFile.transform(e.base64),i),s.append("cover",i),s.append("id",this.authUser.id),this.usersService.changeCoverImage(s).subscribe(e=>{localStorage.setItem("token",e.token),this.authUser=this.getAuthUser.transform(),this.channelUser=this.authUser})}searchVideos(){const e=this.searchVideosForm.value;e.search&&("Watchlist"===this.activeTab.name?this.searchInVideosByAuthor(e):"Videos"===this.activeTab.name&&this.searchInUserVideos(e))}searchInVideosByAuthor(e){this.videoService.searchInVideosByAuthor(e).subscribe(e=>{this.watchlistVideos=e})}searchInUserVideos(e){this.currentUser.videos=[],this.videoService.searchInUserVideos(Object.assign({user_id:this.authUser.id},e)).subscribe(e=>{this.currentUser.videos=e.videos})}subscribeToChannel(e){console.log(e),this.channelService.subscribeToChannel({user_id:this.authUser.id,channel_id:e.id}).subscribe(e=>{this.subscribedToChannel="Subscribed"===e.status,this.subscribersCount=e.subscribers_count,this.channelService.getUserChannelSubscriptions({user_id:this.authUser.id}).subscribe(e=>{this.subject.setUserSubscriptions(e)})})}}return e.\u0275fac=function(s){return new(s||e)(r.Rb(o.a),r.Rb(b.a),r.Rb(c.d),r.Rb(h),r.Rb(l.a),r.Rb(c.a),r.Rb(a.c),r.Rb(d.a),r.Rb(f.a))},e.\u0275cmp=r.Lb({type:e,selectors:[["app-show-channel"]],decls:4,vars:2,consts:[[1,"profile-list"],[4,"ngIf"],["class","channel-not-found",4,"ngIf"],[1,"profile-block"],[3,"hidden",4,"ngIf"],["for","cover-image-input"],["id","cover-image",3,"src"],[1,"sub-block"],[1,"d-flex","align-items-center"],["for","profile-image-input"],["class","avatar list-img",3,"src",4,"ngIf"],["class","avatar","id","profile-image",3,"src",4,"ngIf"],[1,"main-text-1"],[1,"main-text-4"],["class","d-flex align-items-center",4,"ngIf"],[1,"watchlist","pWatchlist"],[1,"profile-list","user-profile-block"],["id","profileList","role","tablist",1,"nav","nav-tabs"],["class","nav-item",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"watchlist-search"],["placeholder","Search","formControlName","search",1,"watchlist-input",3,"keyup.enter"],[1,"fas","fa-search"],[3,"hidden"],["type","file","id","cover-image-input",3,"change"],[3,"imageChanedEvent","autoCrop","viewMode","imageCropped"],[1,"avatar","list-img",3,"src"],["id","profile-image",1,"avatar",3,"src"],["type","file","id","profile-image-input",3,"change"],[3,"imageChanedEvent","aspectRatio","viewMode","resizeToWidth","imageCropped"],[1,"sub-bell","fas","fa-bell"],["class","subscribe-btn",3,"click",4,"ngIf"],["class","subscribe-btn subscribed",3,"click",4,"ngIf"],[1,"subscribe-btn",3,"click"],[1,"subscribe-btn","subscribed",3,"click"],[1,"nav-item"],["data-toggle","tab","role","tab","aria-controls","pWatch","aria-selected","true",1,"nav-link",3,"id","href","click"],[4,"ngFor","ngForOf"],[1,"trending-text"],[3,"options"],["carouselSlide",""],[1,"item","main-carousel-item",3,"click"],["class","main-item-img",3,"src",4,"ngIf"],["class","live-now",4,"ngIf"],[1,"main-item-block"],["class","avatar",3,"src",4,"ngIf"],[1,"main-text-2"],[1,"main-text-3"],[1,"main-item-img",3,"src"],[1,"live-now"],[1,"avatar",3,"src"],["class","main-item-img","src","assets/img/video-thumbnail-default.png",4,"ngIf"],["src","assets/img/video-thumbnail-default.png",1,"main-item-img"],[1,"channel-not-found"]],template:function(e,s){1&e&&(r.Xb(0,"div",0),r.Sb(1,"app-categories"),r.Nc(2,M,27,12,"ng-container",1),r.Nc(3,Q,3,0,"div",2),r.Wb()),2&e&&(r.Cb(2),r.sc("ngIf",s.channelUser),r.Cb(1),r.sc("ngIf",!s.channelUser))},directives:[g.a,n.m,n.l,a.v,a.m,a.g,a.b,a.l,a.f,p.a,m.a,m.c],styles:[".profile-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%}.subscribed[_ngcontent-%COMP%]{background-color:#d6d6d6!important}"]}),e})()}];let D=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(s){return new(s||e)},imports:[[c.e.forChild(B)],c.e]}),e})();var L=i("PCNd");let q=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(s){return new(s||e)},imports:[[n.c,D,L.a,p.b]]}),e})()}}]);