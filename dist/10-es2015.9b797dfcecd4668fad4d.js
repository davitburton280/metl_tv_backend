(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"55j5":function(e,i,n){"use strict";n.r(i),n.d(i,"ChannelsModule",(function(){return Y}));var t=n("ofXK"),s=n("tyNb"),c=n("9xOu"),a=n("3Pt+"),r=n("fXoL"),o=n("FFj9"),b=n("Rnal"),l=n("tk/3");let h=(()=>{class e{constructor(e){this.httpClient=e}changeProfileImage(e){return this.httpClient.post(c.b+"users/change-profile-image",e)}changeCoverImage(e){return this.httpClient.post(c.b+"users/change-cover-image",e)}getUserInfo(e){return this.httpClient.get(c.b+"users/get-user-info",{params:e})}}return e.\u0275fac=function(i){return new(i||e)(r.fc(l.b))},e.\u0275prov=r.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=n("1m4N"),f=n("hKYS"),g=n("kUS0"),d=n("bhfF");function m(e,i){if(1&e){const e=r.Yb();r.Xb(0,"div",23),r.Xb(1,"input",24),r.jc("change",(function(i){return r.Gc(e),r.nc(2).coverChangeEvent(i)})),r.Wb(),r.Xb(2,"ngx-photo-editor",25),r.jc("imageCropped",(function(i){return r.Gc(e),r.nc(2).coverCropped(i)})),r.Wb(),r.Wb()}if(2&e){const e=r.nc(2);r.sc("hidden",!0),r.Cb(2),r.sc("imageChanedEvent",e.coverChangedEvent)("autoCrop",!1)("viewMode",3)}}function p(e,i){if(1&e&&r.Sb(0,"img",26),2&e){const e=r.nc(2);r.sc("src",e.apiUrl+"uploads/avatars/"+e.channelUser.avatar,r.Ic)}}function v(e,i){1&e&&r.Sb(0,"img",27),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function C(e,i){if(1&e){const e=r.Yb();r.Xb(0,"div",23),r.Xb(1,"input",28),r.jc("change",(function(i){return r.Gc(e),r.nc(2).profileChangeEvent(i)})),r.Wb(),r.Xb(2,"ngx-photo-editor",29),r.jc("imageCropped",(function(i){return r.Gc(e),r.nc(2).profileCropped(i)})),r.Wb(),r.Wb()}if(2&e){const e=r.nc(2);r.sc("hidden",!0),r.Cb(2),r.sc("imageChanedEvent",e.profileChangedEvent)("aspectRatio",4/3)("viewMode",1)("resizeToWidth",500)}}function U(e,i){1&e&&(r.Xb(0,"div",8),r.Sb(1,"i",30),r.Xb(2,"a",31),r.Pc(3,"Subscribe"),r.Wb(),r.Wb())}function I(e,i){if(1&e){const e=r.Yb();r.Xb(0,"li",32),r.Xb(1,"a",33),r.jc("click",(function(){r.Gc(e);const n=i.$implicit;return r.nc(2).changeActiveTab(n)})),r.Pc(2),r.Wb(),r.Wb()}if(2&e){const e=i.$implicit,n=r.nc(2);r.Cb(1),r.Hb("active",e===n.activeTab),r.uc("id","",e.link,"-tab"),r.uc("href","#",e.link,"",r.Ic),r.Cb(1),r.Qc(e.name)}}function W(e,i){if(1&e&&r.Sb(0,"img",45),2&e){const e=r.nc(2).$implicit,i=r.nc(5);r.sc("src",i.apiUrl+"uploads/thumbnails/"+e.thumbnail,r.Ic)}}function X(e,i){1&e&&r.Sb(0,"img",45),2&e&&r.sc("src","assets/img/video-thumbnail-default.png",r.Ic)}function w(e,i){1&e&&(r.Xb(0,"span",46),r.Pc(1,"Live now"),r.Wb())}function N(e,i){if(1&e&&r.Sb(0,"img",47),2&e){const e=r.nc(4).$implicit,i=r.nc(3);r.sc("src",i.apiUrl+"uploads/avatars/"+e.avatar,r.Ic)}}function S(e,i){1&e&&r.Sb(0,"img",47),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function V(e,i){if(1&e){const e=r.Yb();r.Xb(0,"div",38),r.jc("click",(function(){r.Gc(e);const i=r.nc().$implicit,n=r.nc(2).$implicit;return r.nc(3).openVideoPage(i,n.username)})),r.Nc(1,W,1,1,"img",39),r.Nc(2,X,1,1,"img",39),r.Nc(3,w,2,0,"span",40),r.Xb(4,"div",41),r.Nc(5,N,1,1,"img",42),r.Nc(6,S,1,1,"img",42),r.Xb(7,"div"),r.Xb(8,"p",12),r.Pc(9),r.Wb(),r.Xb(10,"p",43),r.Pc(11),r.Wb(),r.Xb(12,"p",44),r.Pc(13,"17k watching"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){const e=r.nc().$implicit,i=r.nc(2).$implicit;r.Cb(1),r.sc("ngIf",e.thumbnail),r.Cb(1),r.sc("ngIf",!e.thumbnail),r.Cb(1),r.sc("ngIf","live"===e.status),r.Cb(2),r.sc("ngIf",i.avatar),r.Cb(1),r.sc("ngIf",!i.avatar),r.Cb(3),r.Qc(e.name),r.Cb(2),r.Qc(i.full_name)}}function P(e,i){1&e&&(r.Vb(0),r.Nc(1,V,14,7,"ng-template",37),r.Ub())}function k(e,i){if(1&e&&(r.Vb(0),r.Xb(1,"p",35),r.Pc(2),r.Wb(),r.Xb(3,"owl-carousel-o",36),r.Nc(4,P,2,0,"ng-container",34),r.Wb(),r.Ub()),2&e){const e=r.nc().$implicit,i=r.nc(3);r.Cb(2),r.Qc(e.full_name),r.Cb(1),r.sc("options",i.owlOptions),r.Cb(1),r.sc("ngForOf",e.videos)}}function y(e,i){if(1&e&&(r.Vb(0),r.Nc(1,k,5,3,"ng-container",1),r.Ub()),2&e){const e=i.$implicit;r.Cb(1),r.sc("ngIf",e.videos.length>0)}}function F(e,i){if(1&e&&(r.Vb(0),r.Nc(1,y,2,1,"ng-container",34),r.Ub()),2&e){const e=r.nc(2);r.Cb(1),r.sc("ngForOf",e.watchlistVideos)}}function T(e,i){1&e&&r.Sb(0,"img",49)}function j(e,i){if(1&e&&r.Sb(0,"img",45),2&e){const e=r.nc(2).$implicit,i=r.nc(3);r.tc("src",i.apiUrl+"uploads/thumbnails/"+e.thumbnail,r.Ic)}}function O(e,i){if(1&e&&r.Sb(0,"img",47),2&e){const e=r.nc(5);r.sc("src",e.apiUrl+"uploads/avatars/"+e.authUser.avatar,r.Ic)}}function $(e,i){1&e&&r.Sb(0,"img",47),2&e&&r.sc("src","assets/img/default-user.png",r.Ic)}function E(e,i){if(1&e){const e=r.Yb();r.Xb(0,"div",38),r.jc("click",(function(){r.Gc(e);const i=r.nc().$implicit,n=r.nc(3);return n.openVideoPage(i,n.authUser.username)})),r.Nc(1,T,1,0,"img",48),r.Nc(2,j,1,1,"img",39),r.Xb(3,"div",41),r.Nc(4,O,1,1,"img",42),r.Nc(5,$,1,1,"img",42),r.Xb(6,"div"),r.Xb(7,"p",12),r.Pc(8),r.Wb(),r.Xb(9,"p",43),r.Pc(10),r.Wb(),r.Xb(11,"p",44),r.Pc(12,"17k watching"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){const e=r.nc().$implicit,i=r.nc(3);r.Cb(1),r.sc("ngIf",!e.thumbnail||"undefined"===e.thumbnail),r.Cb(1),r.sc("ngIf",e.thumbnail&&"undefined"!==e.thumbnail),r.Cb(2),r.sc("ngIf",i.authUser.avatar),r.Cb(1),r.sc("ngIf",!i.authUser.avatar),r.Cb(3),r.Qc(e.name),r.Cb(2),r.Qc(i.authUser.full_name)}}function _(e,i){1&e&&(r.Vb(0),r.Nc(1,E,13,6,"ng-template",37),r.Ub())}function R(e,i){if(1&e&&(r.Vb(0),r.Xb(1,"p",35),r.Pc(2,"Recent videos"),r.Wb(),r.Xb(3,"owl-carousel-o"),r.Nc(4,_,2,0,"ng-container",34),r.Wb(),r.Ub()),2&e){const e=r.nc(2);r.Cb(4),r.sc("ngForOf",e.currentUser.videos)}}function x(e,i){if(1&e){const e=r.Yb();r.Vb(0),r.Xb(1,"div",3),r.Nc(2,m,3,4,"div",4),r.Xb(3,"label",5),r.Sb(4,"img",6),r.Wb(),r.Wb(),r.Xb(5,"div",7),r.Xb(6,"div",8),r.Xb(7,"label",9),r.Nc(8,p,1,1,"img",10),r.Nc(9,v,1,1,"img",11),r.Wb(),r.Nc(10,C,3,5,"div",4),r.Xb(11,"div"),r.Xb(12,"p",12),r.Pc(13),r.Wb(),r.Xb(14,"p",13),r.Pc(15,"83,7 subscribers"),r.Wb(),r.Wb(),r.Wb(),r.Nc(16,U,4,0,"div",14),r.Wb(),r.Xb(17,"div",15),r.Xb(18,"div",16),r.Xb(19,"ul",17),r.Nc(20,I,3,5,"li",18),r.Wb(),r.Xb(21,"form",19),r.Xb(22,"div",20),r.Xb(23,"input",21),r.jc("keyup.enter",(function(){return r.Gc(e),r.nc().searchVideos()})),r.Wb(),r.Sb(24,"i",22),r.Wb(),r.Wb(),r.Wb(),r.Nc(25,F,2,1,"ng-container",1),r.Nc(26,R,5,1,"ng-container",1),r.Wb(),r.Ub()}if(2&e){const e=r.nc();r.Cb(2),r.sc("ngIf",e.channelUser.username===e.authUser.username),r.Cb(2),r.sc("src",e.channelUser.cover?e.apiUrl+"uploads/covers/"+e.channelUser.cover:"assets/img/default-thumbnail.png",r.Ic),r.Cb(4),r.sc("ngIf",e.channelUser.avatar),r.Cb(1),r.sc("ngIf",!e.channelUser.avatar),r.Cb(1),r.sc("ngIf",e.channelUser.username===e.authUser.username),r.Cb(3),r.Qc(e.channelUser.channel.name),r.Cb(3),r.sc("ngIf",e.channelUser.username!==e.authUser.username),r.Cb(4),r.sc("ngForOf",e.allTabs),r.Cb(1),r.sc("formGroup",e.searchVideosForm),r.Cb(4),r.sc("ngIf","Watchlist"===e.activeTab.name),r.Cb(1),r.sc("ngIf","Videos"===e.activeTab.name)}}function A(e,i){1&e&&(r.Xb(0,"div",50),r.Xb(1,"p"),r.Pc(2,"Channel with such name is not found"),r.Wb(),r.Wb())}const G=[{path:"show",component:(()=>{class e{constructor(e,i,n,t,s,r,o){this.videoService=e,this.getAuthUser=i,this.router=n,this.usersService=t,this.base64ToFile=s,this.route=r,this.fb=o,this.owlOptions=c.d,this.watchlistVideos=[],this.activeTab=c.e[0],this.allTabs=c.e,this.apiUrl=c.b,this.authUser=this.getAuthUser.transform(),this.passedUsername=this.route.snapshot.queryParams.username,this.searchVideosForm=this.fb.group({search:["",a.t.required]})}ngOnInit(){this.passedUsername&&this.usersService.getUserInfo({username:this.passedUsername}).subscribe(e=>{this.channelUser=e,console.log(this.channelUser.username,this.authUser.username)}),this.videoService.getUserVideos({user_id:this.authUser.id}).subscribe(e=>{this.currentUser=e}),this.videoService.getVideosByAuthor({}).subscribe(e=>{this.watchlistVideos=e})}changeActiveTab(e){this.activeTab=e,this.searchVideos()}openVideoPage(e,i){let n,t;console.log(i),"live"===e.status?(n="user/video/watch",t={session:e.session_name,publisher:i}):(n="videos/play",t={id:e.id}),this.router.navigate([n],{queryParams:t})}coverChangeEvent(e){this.coverChangedEvent=e}profileChangeEvent(e){this.profileChangedEvent=e}profileCropped(e){this.profileBase64=e.base64;const i=`profile_${Date.now()}.jpg`,n=new FormData;n.append("avatar_file",this.base64ToFile.transform(e.base64),i),n.append("avatar",i),n.append("id",this.authUser.id),this.usersService.changeProfileImage(n).subscribe(e=>{localStorage.setItem("token",e.token),this.authUser=this.getAuthUser.transform(),this.channelUser=this.authUser})}coverCropped(e){this.coverBase64=e.base64;const i=new FormData,n=`cover_${Date.now()}.jpg`;i.append("cover_file",this.base64ToFile.transform(e.base64),n),i.append("cover",n),i.append("id",this.authUser.id),this.usersService.changeCoverImage(i).subscribe(e=>{localStorage.setItem("token",e.token),this.authUser=this.getAuthUser.transform(),this.channelUser=this.authUser})}searchVideos(){const e=this.searchVideosForm.value;e.search&&("Watchlist"===this.activeTab.name?this.searchInVideosByAuthor(e):"Videos"===this.activeTab.name&&this.searchInUserVideos(e))}searchInVideosByAuthor(e){this.videoService.searchInVideosByAuthor(e).subscribe(e=>{this.watchlistVideos=e})}searchInUserVideos(e){this.currentUser.videos=[],this.videoService.searchInUserVideos(Object.assign({user_id:this.authUser.id},e)).subscribe(e=>{this.currentUser.videos=e.videos})}}return e.\u0275fac=function(i){return new(i||e)(r.Rb(o.a),r.Rb(b.a),r.Rb(s.d),r.Rb(h),r.Rb(u.a),r.Rb(s.a),r.Rb(a.c))},e.\u0275cmp=r.Lb({type:e,selectors:[["app-show-channel"]],decls:4,vars:2,consts:[[1,"profile-list"],[4,"ngIf"],["class","channel-not-found",4,"ngIf"],[1,"profile-block"],[3,"hidden",4,"ngIf"],["for","cover-image-input"],["id","cover-image",3,"src"],[1,"sub-block"],[1,"d-flex","align-items-center"],["for","profile-image-input"],["class","avatar list-img",3,"src",4,"ngIf"],["class","avatar","id","profile-image",3,"src",4,"ngIf"],[1,"main-text-1"],[1,"main-text-4"],["class","d-flex align-items-center",4,"ngIf"],[1,"watchlist","pWatchlist"],[1,"profile-list","user-profile-block"],["id","profileList","role","tablist",1,"nav","nav-tabs"],["class","nav-item",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"watchlist-search"],["placeholder","Search","formControlName","search",1,"watchlist-input",3,"keyup.enter"],[1,"fas","fa-search"],[3,"hidden"],["type","file","id","cover-image-input",3,"change"],[3,"imageChanedEvent","autoCrop","viewMode","imageCropped"],[1,"avatar","list-img",3,"src"],["id","profile-image",1,"avatar",3,"src"],["type","file","id","profile-image-input",3,"change"],[3,"imageChanedEvent","aspectRatio","viewMode","resizeToWidth","imageCropped"],[1,"sub-bell","fas","fa-bell"],[1,"subscribe-btn"],[1,"nav-item"],["data-toggle","tab","role","tab","aria-controls","pWatch","aria-selected","true",1,"nav-link",3,"id","href","click"],[4,"ngFor","ngForOf"],[1,"trending-text"],[3,"options"],["carouselSlide",""],[1,"item","main-carousel-item",3,"click"],["class","main-item-img",3,"src",4,"ngIf"],["class","live-now",4,"ngIf"],[1,"main-item-block"],["class","avatar",3,"src",4,"ngIf"],[1,"main-text-2"],[1,"main-text-3"],[1,"main-item-img",3,"src"],[1,"live-now"],[1,"avatar",3,"src"],["class","main-item-img","src","assets/img/video-thumbnail-default.png",4,"ngIf"],["src","assets/img/video-thumbnail-default.png",1,"main-item-img"],[1,"channel-not-found"]],template:function(e,i){1&e&&(r.Xb(0,"div",0),r.Sb(1,"app-categories"),r.Nc(2,x,27,11,"ng-container",1),r.Nc(3,A,3,0,"div",2),r.Wb()),2&e&&(r.Cb(2),r.sc("ngIf",i.channelUser),r.Cb(1),r.sc("ngIf",!i.channelUser))},directives:[f.a,t.m,t.l,a.v,a.m,a.g,a.b,a.l,a.f,g.a,d.a,d.c],styles:[".profile-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%}"]}),e})()}];let M=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(i){return new(i||e)},imports:[[s.e.forChild(G)],s.e]}),e})();var Q=n("PCNd");let Y=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(i){return new(i||e)},imports:[[t.c,M,Q.a,g.b]]}),e})()}}]);