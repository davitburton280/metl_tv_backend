{"version":3,"sources":["webpack:///src/app/channels/show-channel/watchlist-tab/watchlist-tab.component.html","webpack:///src/app/channels/show-channel/watchlist-tab/watchlist-tab.component.ts","webpack:///src/app/channels/show-channel/videos-tab/videos-tab.component.html","webpack:///src/app/channels/show-channel/videos-tab/videos-tab.component.ts","webpack:///src/app/channels/show-channel/playlists-tab/playlists-tab.component.html","webpack:///src/app/channels/show-channel/playlists-tab/playlists-tab.component.ts","webpack:///src/app/channels/show-channel/channel-profile/channel-profile.component.html","webpack:///src/app/channels/show-channel/channel-profile/channel-profile.component.ts","webpack:///src/app/channels/show-channel/about-tab/about-tab.component.html","webpack:///src/app/channels/show-channel/about-tab/about-tab.component.ts","webpack:///src/app/channels/show-channel/show-channel.component.html","webpack:///src/app/channels/channels-routing.module.ts","webpack:///src/app/channels/show-channel/show-channel.component.ts","webpack:///src/app/channels/channels.module.ts"],"names":["WatchlistTabComponent","videoService","subjectService","router","getExactParams","stocksService","getAuthUser","subject","cdr","apiUrl","subscriptions","userStocks","filteredStocks","stocksLoading","this","authUser","transform","search","localStorage","getItem","push","currentUserStocks","pipe","filter","d","initial","subscribe","dt","stocks","s","us","name","toLowerCase","includes","updateFollowedStocks","user_id","id","user_stocks","changeUserStocks","empty","length","detectChanges","e","sendData","order_type","rows","JSON","stringify","dragdrop","updateUserStocksPriority","setItem","hasOwnProperty","token","forEach","unsubscribe","VideosTabComponent","showFilters","filters","userVideos","videosLoaded","getToggleFiltersData","params","channelUser","getUserVideos","videos","PlaylistsTabComponent","playlistsService","dialog","playlists","trackByElement","getPlaylists","getFiltersToggleState","get","channel_id","channel","open","data","afterClosed","playlist","firstVideoId","navigate","queryParams","playlist_id","channelId","confirmed","removePlaylist","$event","preventDefault","ChannelProfileComponent","usersService","userStore","base64ToFile","channelService","usersConnectionsStore","groupsMessagesStore","notificationsStore","socketService","loader","fb","subscribedToChannel","subscribersCount","changingImage","editMode","attemptedToConnect","isBlocked","usersConnectionStatus","checkChannelSubscription","initChannelForm","checkIfUsersConnected","getAcceptedDeclinedRequests","getConnectWithUser","getDisconnectUsers","cancelledUsersConnecting","getBlockUnblockUser","getConnectionsChanges","usersMessages$","acceptedConnection","notification","console","log","to_user","from_user","declinedConnection","channelForm","group","avatar","cover","required","username","patchValue","channel_user_id","usersConnection","is_blocked","event","coverChangedEvent","profileChangedEvent","dataLoading","profileBase64","base64","filename","Date","now","fd","FormData","append","changeProfileImage","changeAuthUserInfo","coverBase64","changeCoverImage","subscribeToChannel","status","subscribers_count","getUserChannelSubscriptions","setUserSubscriptions","setAuthUser","value","valid","changeChannelDetails","foundUserMessages","usersMessages","find","um","showBottomChatBox","changeUser","connectWithUser","msg","first_name","last_name","connection","cancelUsersConnecting","connection_id","disconnectUsers","test","detectImageChange","AboutTabComponent","fixLineBreaks","aboutForm","description","maxLength","saveDescription","document","querySelector","innerHTML","saveChannelDescription","ShowChannelComponent","ChannelsRoutingModule","ChannelsModule","routes","path","component","route","auth","updateStocks","usersMessagesStore","toastr","chatService","allTabs","showChatBox","passedUsername","snapshot","passedTab","tab","searchVideosForm","activeTab","tabs","getUserInfo","setToggleFiltersData","channelLoading","own_channel","watchListTab","getSearchResults","searchInUserVideos","searchInPlaylists","videosTab","playlistsTab","tag","maxWidth","maxHeight","height","width","panelClass","stock","result","isStockFollowed","title","forChild"],"mappings":"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","file":"x","sourcesContent":["<div *ngIf=\"filteredStocks && channelUser.username === authUser.username\">\r\n    <mat-spinner *ngIf=\"stocksLoading==='loading'\" [diameter]=\"20\"></mat-spinner>\r\n    <small class=\"error\" *ngIf=\"userStocks?.length === 0 && stocksLoading==='finished'\">\r\n        No stocks added to watchlist</small>\r\n    <app-stock-tiles [stocks]=\"filteredStocks\" [userStocks]=\"userStocks\" *ngIf=\"userStocks?.length > 0\"\r\n                     (updatedStocksList)=\"saveUpdatedStocksList($event)\" [followingAllowed]=\"true\"\r\n                     (updatedStocksPriority)=\"updateStocksPriority($event)\"\r\n    ></app-stock-tiles>\r\n</div>\r\n","import {ChangeDetectorRef, Component, Input, OnDestroy, OnInit} from '@angular/core';\r\nimport {VideoService} from '@core/services/video.service';\r\nimport {API_URL} from '@core/constants/global';\r\nimport {Router} from '@angular/router';\r\nimport {Subscription} from 'rxjs';\r\nimport {SubjectService} from '@core/services/subject.service';\r\nimport {FilterOutFalsyValuesFromObjectPipe} from '@shared/pipes/filter-out-falsy-values-from-object.pipe';\r\nimport {StocksService} from '@core/services/stocks.service';\r\nimport {GetAuthUserPipe} from '@shared/pipes/get-auth-user.pipe';\r\nimport {User} from '@shared/models/user';\r\nimport {updateStockDetails} from '@core/helpers/update-stock-details';\r\nimport {LoaderService} from '@core/services/loader.service';\r\nimport {PageEvent} from '@angular/material/paginator';\r\nimport {filter} from 'rxjs/operators';\r\nimport {Stock} from '@shared/models/stock';\r\n\r\n@Component({\r\n    selector: 'app-watchlist-tab',\r\n    templateUrl: './watchlist-tab.component.html',\r\n    styleUrls: ['./watchlist-tab.component.scss']\r\n})\r\nexport class WatchlistTabComponent implements OnInit, OnDestroy {\r\n    apiUrl = API_URL;\r\n    authUser: User;\r\n    search: string | null;\r\n\r\n    subscriptions: Subscription[] = [];\r\n    userStocks: Stock[] = [];\r\n    filteredStocks: Stock[] = [];\r\n\r\n    stocksLoading = 'idle';\r\n\r\n\r\n    @Input('channelUser') channelUser;\r\n\r\n    constructor(\r\n        private videoService: VideoService,\r\n        private subjectService: SubjectService,\r\n        public router: Router,\r\n        private getExactParams: FilterOutFalsyValuesFromObjectPipe,\r\n        private stocksService: StocksService,\r\n        private getAuthUser: GetAuthUserPipe,\r\n        private subject: SubjectService,\r\n        private cdr: ChangeDetectorRef,\r\n    ) {\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.authUser = this.getAuthUser.transform();\r\n        this.search = localStorage.getItem('searchStock');\r\n        this.stocksLoading = 'loading';\r\n        this.subscriptions.push(\r\n            this.subject.currentUserStocks\r\n                .pipe(filter(d => !d.initial))\r\n                .subscribe(dt => {\r\n                    this.userStocks = dt.stocks;\r\n                    this.filteredStocks = this.userStocks;\r\n                    this.stocksLoading = 'finished';\r\n                }));\r\n    }\r\n\r\n    getSearchResults(s) {\r\n        this.search = s;\r\n        if (s.search) {\r\n            this.filteredStocks = this.userStocks.filter(us => us.name.toLowerCase().includes(s.search));\r\n        } else {\r\n            this.filteredStocks = this.userStocks;\r\n        }\r\n    }\r\n\r\n    saveUpdatedStocksList(stocks) {\r\n        this.stocksLoading = 'loading';\r\n        this.subscriptions.push(this.stocksService.updateFollowedStocks({\r\n            user_id: this.authUser.id,\r\n            ...{stocks}\r\n        }).subscribe(dt => {\r\n            this.userStocks = dt?.user_stocks || [];\r\n            this.subject.changeUserStocks({stocks: this.userStocks, empty: this.userStocks.length === 0});\r\n            this.stocksLoading = 'finished';\r\n            this.cdr.detectChanges();\r\n        }));\r\n    }\r\n\r\n    updateStocksPriority(e) {\r\n        const sendData = {\r\n            order_type: 'custom',\r\n            rows: JSON.stringify(e),\r\n            user_id: this.authUser.id\r\n        };\r\n\r\n        this.subject.changeUserStocks({stocks: e, dragdrop: true});\r\n        this.stocksService.updateUserStocksPriority(sendData).subscribe(dt => {\r\n            localStorage.setItem('token', (dt.hasOwnProperty('token') ? dt.token : ''));\r\n        });\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.subscriptions.forEach(s => s.unsubscribe());\r\n    }\r\n\r\n}\r\n","<app-video-filters *ngIf=\"showFilters\" (filter)=\"getFilteredVideos($event)\"></app-video-filters>\r\n<app-videos-list-holder [videos]=\"channelUser.videos\" [removable]=\"authUser.username === channelUser.username\"></app-videos-list-holder>\r\n","import {Component, Input, OnInit} from '@angular/core';\r\nimport {API_URL} from '@core/constants/global';\r\nimport {Router} from '@angular/router';\r\nimport {VideoService} from '@core/services/video.service';\r\nimport {SubjectService} from '@core/services/subject.service';\r\nimport {FilterOutFalsyValuesFromObjectPipe} from '@shared/pipes/filter-out-falsy-values-from-object.pipe';\r\n\r\n@Component({\r\n    selector: 'app-videos-tab',\r\n    templateUrl: './videos-tab.component.html',\r\n    styleUrls: ['./videos-tab.component.scss']\r\n})\r\nexport class VideosTabComponent implements OnInit {\r\n\r\n    apiUrl = API_URL;\r\n    showFilters = false;\r\n    search = '';\r\n    filters = null;\r\n    userVideos = [];\r\n    videosLoaded = false;\r\n\r\n    @Input('channelUser') channelUser;\r\n    @Input('authUser') authUser;\r\n\r\n    constructor(\r\n        public router: Router,\r\n        private videoService: VideoService,\r\n        private subjectService: SubjectService,\r\n        private getExactParams: FilterOutFalsyValuesFromObjectPipe\r\n    ) {\r\n    }\r\n\r\n    ngOnInit(): void {\r\n\r\n        this.subjectService.getToggleFiltersData().subscribe(dt => {\r\n            this.showFilters = dt;\r\n        });\r\n    }\r\n\r\n    getUserVideos(params) {\r\n\r\n        params = this.getExactParams.transform(params);\r\n        params.user_id = this.channelUser.id;\r\n        this.videoService.getUserVideos(params).subscribe(dt => {\r\n            this.videosLoaded = true;\r\n            this.channelUser.videos = dt?.videos;\r\n        });\r\n    }\r\n\r\n    getSearchResults(s) {\r\n        this.search = s;\r\n        this.getUserVideos({search: this.search, filters: this.filters});\r\n    }\r\n\r\n    getFilteredVideos(e) {\r\n        this.filters = e;\r\n        this.getUserVideos({search: this.search, filters: this.filters});\r\n    }\r\n\r\n}\r\n","<app-video-filters *ngIf=\"showFilters\" (filter)=\"getFilteredPlaylists($event)\"></app-video-filters>\r\n<div class=\"playlist-tab\">\r\n    <ng-container *ngIf=\"authUser.username === channelUser.username\">\r\n        <button class=\"btn new-playlist\" (click)=\"openAddPlaylistModal()\">Add New Playlist</button>\r\n        <table *ngIf=\"playlists.length > 0\" class=\"table-responsive\">\r\n            <tr>\r\n                <th>Playlist</th>\r\n                <th>Visibility</th>\r\n                <th>Created at</th>\r\n                <th>Last updated</th>\r\n                <th>Video count</th>\r\n                <th></th>\r\n            </tr>\r\n            <tr *ngFor=\"let playlist of playlists; trackBy:trackByElement\">\r\n                <td>\r\n                    <div class=\"img-info\">\r\n                        <img class=\"thumbnail\" [src]=\"playlist.thumbnail|getImgPath\" (click)=\"goToEditPage(playlist)\">\r\n                        <div class=\"info\">\r\n                            <h3>{{playlist.name}}</h3>\r\n                            <p>{{playlist.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    <ng-container *ngIf=\"playlist.privacy\">\r\n                        <mat-icon>visibility_off</mat-icon>\r\n                        <span>Private</span>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"!playlist.privacy\">\r\n                        <mat-icon>visibility_on</mat-icon>\r\n                        <span>Public</span>\r\n                    </ng-container>\r\n                </td>\r\n                <td>\r\n                    <span>{{playlist.created_at|date: 'd MMM, yyyy'}}</span>\r\n                </td>\r\n                <td>\r\n                    <span>{{playlist.updated_at|date: 'd MMM, yyyy'}}</span>\r\n                </td>\r\n                <td>\r\n                    <span>{{playlist.videos.length}}</span>\r\n                </td>\r\n                <td>\r\n                    <span class=\"material-icons\" (click)=\"goToEditPage(playlist)\">create</span>\r\n                    <mat-icon (click)=\"removePlaylist(playlist.id, channelUser.id)\">delete</mat-icon>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"authUser.username !== channelUser.username\">\r\n        <div class=\"playlists-items\">\r\n            <ng-container *ngFor=\"let playlist of playlists\">\r\n                <div class=\"item\" >\r\n                    <div class=\"top-wrap\" (click)=\"openPlaylistPage(playlist, playlist.videos[0]?.id)\">\r\n                        <img class=\"thumbnail\" [src]=\"playlist.thumbnail|getImgPath\">\r\n                        <div class=\"overlay-info\">\r\n                            <p class=\"icon\"><span class=\"material-icons\">playlist_play</span></p>\r\n                            <p>{{playlist.name}}</p>\r\n                            <p class=\"video-count\">{{playlist.videos.length + (playlist.videos.length === 1 ? ' video' : ' videos')}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"info\">\r\n                        <h2>{{playlist.name}}</h2>\r\n                        <p>{{playlist.description}}</p>\r\n                    </div>\r\n                </div>\r\n            </ng-container>\r\n        </div>\r\n\r\n    </ng-container>\r\n    <div id=\"no-playlists-found\" *ngIf=\"playlists.length === 0\">\r\n        <small class=\"error\">No playlists found for this channel</small>\r\n    </div>\r\n</div>\r\n","import {Component, Input, OnInit} from '@angular/core';\r\nimport {API_URL} from '@core/constants/global';\r\nimport {Router} from '@angular/router';\r\nimport {PlaylistsService} from '@core/services/playlists.service';\r\nimport {AddPlaylistDialogComponent} from '@core/components/modals/add-playlist-dialog/add-playlist-dialog.component';\r\nimport {MatDialog} from '@angular/material/dialog';\r\nimport {SubjectService} from '@core/services/subject.service';\r\nimport {FilterOutFalsyValuesFromObjectPipe} from '@shared/pipes/filter-out-falsy-values-from-object.pipe';\r\nimport {Subscription} from 'rxjs';\r\nimport {ConfirmationDialogComponent} from '@core/components/modals/confirmation-dialog/confirmation-dialog.component';\r\nimport trackByElement from '@core/helpers/track-by-element';\r\n\r\n@Component({\r\n    selector: 'app-playlists-tab',\r\n    templateUrl: './playlists-tab.component.html',\r\n    styleUrls: ['./playlists-tab.component.scss']\r\n})\r\nexport class PlaylistsTabComponent implements OnInit {\r\n    playlists = [];\r\n    apiUrl = API_URL;\r\n    showFilters = false;\r\n    search = '';\r\n    filters = null;\r\n    subscriptions: Subscription[] = [];\r\n    trackByElement = trackByElement;\r\n    @Input('channelUser') channelUser;\r\n    @Input('authUser') authUser;\r\n\r\n    constructor(\r\n        public router: Router,\r\n        private playlistsService: PlaylistsService,\r\n        private subjectService: SubjectService,\r\n        private dialog: MatDialog,\r\n        private getExactParams: FilterOutFalsyValuesFromObjectPipe\r\n    ) {\r\n\r\n    }\r\n\r\n\r\n    ngOnInit(): void {\r\n        this.search = localStorage.getItem('search');\r\n        this.getPlaylists({search: this.search, filters: this.filters});\r\n        this.getFiltersToggleState();\r\n    }\r\n\r\n    getFiltersToggleState() {\r\n        this.subscriptions.push(this.subjectService.getToggleFiltersData().subscribe(dt => {\r\n            this.showFilters = dt;\r\n        }));\r\n    }\r\n\r\n\r\n    getPlaylists(params) {\r\n\r\n        params = this.getExactParams.transform(params);\r\n\r\n        this.playlistsService.get({\r\n            channel_id: this.channelUser.channel.id,\r\n            user_id: this.authUser.id, ...params\r\n        }).subscribe(dt => {\r\n            this.playlists = dt;\r\n            // console.log(this.authUser, this.channelUser)\r\n        });\r\n    }\r\n\r\n    openAddPlaylistModal() {\r\n        this.dialog.open(AddPlaylistDialogComponent,\r\n            {\r\n                data: {channel_id: this.channelUser.channel.id}\r\n            })\r\n            .afterClosed().subscribe(dt => {\r\n            this.getPlaylists({search: this.search, filters: this.filters});\r\n        });\r\n    }\r\n\r\n    openPlaylistPage(playlist, firstVideoId) {\r\n        const route = 'videos/play';\r\n        const params = {id: firstVideoId, playlist_id: playlist.id};\r\n        this.router.navigate([route], {queryParams: params});\r\n    }\r\n\r\n    getSearchResults(search) {\r\n        this.search = search;\r\n        this.getPlaylists({search, filters: this.filters});\r\n    }\r\n\r\n    getFilteredPlaylists(filters) {\r\n        this.filters = filters;\r\n        this.getPlaylists({search: this.search, filters});\r\n    }\r\n\r\n    goToEditPage(playlist) {\r\n        this.router.navigate(['playlists/single/' + playlist.id]);\r\n    }\r\n\r\n    removePlaylist(id, channelId) {\r\n        this.dialog.open(ConfirmationDialogComponent).afterClosed().subscribe(confirmed => {\r\n            if (confirmed) {\r\n                this.playlistsService.removePlaylist({id, channel_id: channelId}).subscribe(dt => {\r\n                    this.getPlaylists({search: this.search, filters: this.filters});\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n","<form [formGroup]=\"channelForm\">\r\n    <div class=\"profile-block\">\r\n        <div [hidden]=\"true\" *ngIf=\"channelUser.username === authUser.username\">\r\n            <input type=\"file\" id=\"cover-image-input\" (change)=\"coverChangeEvent($event)\"/>\r\n            <input type=\"hidden\" formControlName=\"cover\">\r\n            <ngx-photo-editor\r\n                [imageChanedEvent]=\"coverChangedEvent\"\r\n                (imageCropped)=\"coverCropped($event)\"\r\n                [autoCrop]=\"false\"\r\n                [viewMode]=\"3\"></ngx-photo-editor>\r\n        </div>\r\n\r\n        <div class=\"cover-image-container\">\r\n            <label for=\"cover-image-input\">\r\n                <img id=\"cover-image\" [src]=\"channelUser.channel?.cover|getImgPath: 'covers'\"\r\n                     (load)=\"detectImageChange()\">\r\n            </label>\r\n            <button mat-icon-button type=\"button\" class=\"remove-cover-btn\" (click)=\"removeCover()\"\r\n                    *ngIf=\"editMode && channelUser.channel.cover\">\r\n                <mat-icon>clear</mat-icon>\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"sub-block\">\r\n        <div id=\"channel-name-avatar\">\r\n            <div class=\"avatar-container\">\r\n                <label for=\"profile-image-input\">\r\n                    <img class=\"avatar\" [ngStyle]=\"{opacity: editMode ? 0.5: 1}\" id=\"profile-image\"\r\n                         (load)=\"detectImageChange()\"\r\n                         [src]=\"channelUser.channel.avatar|getImgPath: 'avatars'\">\r\n                    <mat-icon id=\"add-photo-btn\" *ngIf=\"editMode && !channelUser.channel.avatar\">add</mat-icon>\r\n                </label>\r\n                <mat-icon (click)=\"removeAvatar()\" class=\"remove-avatar-btn\"\r\n                          *ngIf=\"editMode && channelUser.channel.avatar\">clear\r\n                </mat-icon>\r\n            </div>\r\n\r\n            <div [hidden]=\"true\" *ngIf=\"this.channelUser.username === this.authUser.username\">\r\n                <input type=\"file\" id=\"profile-image-input\" (change)=\"profileChangeEvent($event)\"/>\r\n                <input type=\"hidden\" formControlName=\"avatar\">\r\n                <ngx-photo-editor\r\n                    [imageChanedEvent]=\"profileChangedEvent\"\r\n                    (imageCropped)=\"profileCropped($event)\"\r\n                    [aspectRatio]=\"4/3\"\r\n                    [viewMode]=\"1\"\r\n                    [resizeToWidth]=\"500\"></ngx-photo-editor>\r\n\r\n            </div>\r\n            <div>\r\n                <p class=\"channel-name\" id=\"channel-name\" *ngIf=\"!editMode\">{{channelUser.channel.name}}</p>\r\n                <mat-form-field *ngIf=\"editMode\">\r\n                    <input matInput formControlName=\"name\" id=\"channel-name-input\"\r\n                           (keyup.enter)=\"$event.preventDefault()\">\r\n                </mat-form-field>\r\n                <p class=\"subscribers-count\">{{subscribersCount + ' subscriber' + (subscribersCount === 1 ? '' : 's')}} </p>\r\n            </div>\r\n\r\n        </div>\r\n        <div class=\"loader\" *ngIf=\"changingImage\">\r\n            <mat-spinner [diameter]=\"50\"></mat-spinner>\r\n        </div>\r\n        <div id=\"connection-status-buttons\"  *ngIf=\"channelUser.username !== authUser.username\">\r\n            <!--            <i class=\"sub-bell fas fa-bell\"></i>-->\r\n            <a class=\"add-friend-btn\" (click)=\"connectWithUser()\"\r\n               *ngIf=\"usersConnectionStatus==='idle'\">\r\n                <mat-icon>person_add</mat-icon>\r\n                <span>Connect</span>\r\n            </a>\r\n\r\n            <a class=\"waiting-for-confirmation-btn\"\r\n               *ngIf=\"usersConnectionStatus==='pending'\" [matMenuTriggerFor]=\"pendingMenu\">\r\n                <mat-icon>check</mat-icon>\r\n                <span>Waiting for confirmation</span>\r\n            </a>\r\n\r\n            <mat-menu #pendingMenu=\"matMenu\">\r\n                <button mat-menu-item (click)=\"cancelUsersConnecting(usersConnection)\">\r\n                    <mat-icon>close</mat-icon>\r\n                    <span>Cancel</span>\r\n                </button>\r\n            </mat-menu>\r\n\r\n            <button class=\"users-connected-btn\" *ngIf=\"usersConnectionStatus==='connected' \" [matMenuTriggerFor]=\"menu\">\r\n                <mat-icon>check</mat-icon>\r\n                <span>Connected</span>\r\n            </button>\r\n\r\n            <mat-menu #menu=\"matMenu\">\r\n                <button mat-menu-item (click)=\"disconnectUser()\">\r\n                    <mat-icon>close</mat-icon>\r\n                    <span>Disconnect</span>\r\n                </button>\r\n            </mat-menu>\r\n\r\n            <a (click)=\"toggleBottomChatBox()\" class=\"toggle-chat-box-btn\" *ngIf=\"isMessageBtnShown()\">\r\n                <mat-icon>chat</mat-icon>\r\n                <span>Message</span>\r\n            </a>\r\n            <a class=\"subscribe-btn\" *ngIf=\"!subscribedToChannel\" (click)=\"subscribeToChannel(channelUser.channel)\">\r\n                <mat-icon>favorite_border</mat-icon>\r\n                <span>Subscribe</span>\r\n            </a>\r\n            <a class=\"subscribe-btn subscribed\" *ngIf=\"subscribedToChannel\"\r\n               (click)=\"subscribeToChannel(channelUser.channel)\">\r\n                <mat-icon>favorite</mat-icon>\r\n                <span>Subscribed</span>\r\n            </a>\r\n        </div>\r\n        <div class=\"d-flex align-items-center\" *ngIf=\"channelUser.username === authUser.username\">\r\n            <button class=\"btn\" type=\"button\" id=\"edit-channel\" (click)=\"toggleEditMode()\" *ngIf=\"!editMode\">\r\n                <mat-icon>edit</mat-icon>\r\n                Edit channel\r\n            </button>\r\n            <button class=\"btn\" type=\"button\" id=\"cancel-changes\" *ngIf=\"editMode\" (click)=\"toggleEditMode()\">\r\n                <mat-icon>cancel</mat-icon>\r\n                Cancel\r\n            </button>\r\n            <button class=\"btn\" type=\"button\" id=\"save-channel-details\" *ngIf=\"editMode\" (click)=\"saveChanges()\">\r\n                <mat-icon>save</mat-icon>\r\n                Save changes\r\n            </button>\r\n        </div>\r\n    </div>\r\n</form>\r\n","import {Component, EventEmitter, Input, OnDestroy, OnInit, Output} from '@angular/core';\r\nimport {API_URL} from '@core/constants/global';\r\nimport {CroppedEvent} from 'ngx-photo-editor';\r\nimport {UsersService} from '@core/services/users.service';\r\nimport {Base64ToFilePipe} from '@shared/pipes/base64-to-file.pipe';\r\nimport {GetAuthUserPipe} from '@shared/pipes/get-auth-user.pipe';\r\nimport {ChannelsService} from '@core/services/channels.service';\r\nimport {SubjectService} from '@core/services/subject.service';\r\nimport {LoaderService} from '@core/services/loader.service';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {Subscription} from 'rxjs';\r\nimport {SocketIoService} from '@core/services/socket-io.service';\r\nimport {NotificationsSubjectStoreService} from '@core/services/stores/notifications-subject-store.service';\r\nimport {UsersMessagesSubjectService} from '@core/services/stores/users-messages-subject.service';\r\nimport {Router} from '@angular/router';\r\nimport {GroupsMessagesSubjectService} from '@core/services/stores/groups-messages-subject.service';\r\nimport {UserStoreService} from '@core/services/stores/user-store.service';\r\n\r\n@Component({\r\n    selector: 'app-channel-profile',\r\n    templateUrl: './channel-profile.component.html',\r\n    styleUrls: ['./channel-profile.component.scss']\r\n})\r\nexport class ChannelProfileComponent implements OnInit, OnDestroy {\r\n    apiUrl = API_URL;\r\n\r\n    profileChangedEvent: any;\r\n    coverChangedEvent: any;\r\n    profileBase64: any;\r\n    coverBase64: any;\r\n\r\n    subscribedToChannel = false;\r\n    subscribersCount = 0;\r\n\r\n    changingImage = false;\r\n    editMode = false;\r\n\r\n    channelForm: FormGroup;\r\n    subscriptions: Subscription[] = [];\r\n    attemptedToConnect = false;\r\n    usersConnection;\r\n    isBlocked = false;\r\n    usersConnectionStatus = 'idle';\r\n\r\n\r\n    @Input('channelUser') channelUser;\r\n    @Input('authUser') authUser;\r\n\r\n    constructor(\r\n        private usersService: UsersService,\r\n        private userStore: UserStoreService,\r\n        private base64ToFile: Base64ToFilePipe,\r\n        private getAuthUser: GetAuthUserPipe,\r\n        private channelService: ChannelsService,\r\n        private subject: SubjectService,\r\n        private usersConnectionsStore: UsersMessagesSubjectService,\r\n        private groupsMessagesStore: GroupsMessagesSubjectService,\r\n        private notificationsStore: NotificationsSubjectStoreService,\r\n        private socketService: SocketIoService,\r\n        public loader: LoaderService,\r\n        private fb: FormBuilder,\r\n    ) {\r\n\r\n\r\n    }\r\n\r\n    ngOnInit(): void {\r\n\r\n        if (this.channelUser) {\r\n            this.checkChannelSubscription();\r\n            this.initChannelForm();\r\n            // this.detectImageChange();\r\n            this.checkIfUsersConnected();\r\n            this.getAcceptedDeclinedRequests();\r\n            this.getConnectWithUser();\r\n            this.getDisconnectUsers();\r\n            this.cancelledUsersConnecting();\r\n            this.getBlockUnblockUser();\r\n            this.getConnectionsChanges();\r\n        }\r\n    }\r\n\r\n    getConnectionsChanges() {\r\n        this.subscriptions.push(this.usersConnectionsStore.usersMessages$.subscribe((dt: any) => {\r\n            // console.log('connection changed!!!', dt, this.channelUser.id)\r\n            //\r\n            //     if (dt.filter(d => d.id === this.channelUser.id)) {\r\n            //         this.usersConnectionStatus = 'connected';\r\n            //         this.isBlocked = false;\r\n            //     }\r\n        }));\r\n    }\r\n\r\n    getAcceptedDeclinedRequests() {\r\n        this.subscriptions.push(this.socketService.acceptedConnection().subscribe((dt: any) => {\r\n            const {notification} = dt;\r\n            console.log(notification)\r\n            if ((notification.to_user.id === this.authUser.id && notification.from_user.id === this.channelUser.id)\r\n                || (notification.to_user.id === this.channelUser.id && notification.from_user.id === this.authUser.id)) {\r\n                this.usersConnectionStatus = 'connected';\r\n                this.isBlocked = false;\r\n            }\r\n        }));\r\n\r\n        this.subscriptions.push(this.socketService.declinedConnection().subscribe((dt: any) => {\r\n            console.log('declined')\r\n            this.usersConnectionStatus = 'idle';\r\n        }));\r\n    }\r\n\r\n\r\n    initChannelForm() {\r\n        this.channelForm = this.fb.group({\r\n            id: [''],\r\n            avatar: [''],\r\n            cover: [''],\r\n            name: ['', Validators.required],\r\n            username: ['']\r\n        });\r\n\r\n        this.channelForm.patchValue({\r\n            name: this.channelUser.channel.name,\r\n            id: this.channelUser.channel.id,\r\n            username: this.channelUser.username,\r\n            avatar: this.channelUser.channel.avatar,\r\n            cover: this.channelUser.channel.cover\r\n        });\r\n    }\r\n\r\n    checkIfUsersConnected() {\r\n        this.usersService.checkIfUsersConnected({\r\n            user_id: this.authUser.id,\r\n            channel_user_id: this.channelUser.id\r\n        }).subscribe(dt => {\r\n            this.usersConnection = dt;\r\n            if (dt) {\r\n                this.usersConnectionStatus = dt.confirmed ? 'connected' : 'pending';\r\n                this.isBlocked = !!dt.is_blocked;\r\n            }\r\n        });\r\n    }\r\n\r\n    coverChangeEvent(event: any) {\r\n        this.coverChangedEvent = event;\r\n    }\r\n\r\n    profileChangeEvent(event: any) {\r\n        this.profileChangedEvent = event;\r\n    }\r\n\r\n    detectImageChange() {\r\n        // document.querySelector('img.avatar').addEventListener('load', () => {\r\n        //     console.log('Loading image!!!')\r\n        if (this.profileChangedEvent || this.coverChangedEvent) {\r\n            this.loader.dataLoading = false;\r\n            this.changingImage = false;\r\n            console.log('Avatar changed');\r\n            console.log(this.changingImage);\r\n        }\r\n        // });\r\n    }\r\n\r\n\r\n    profileCropped(event: CroppedEvent) {\r\n        // this.loader.dataLoading = true;\r\n\r\n        this.changingImage = true;\r\n        this.profileBase64 = event.base64;\r\n        const filename = `avatar_${Date.now()}.jpg`;\r\n        const fd = new FormData();\r\n        this.channelForm.patchValue({avatar: filename});\r\n        fd.append('avatar_file', this.base64ToFile.transform(event.base64), filename);\r\n        fd.append('avatar', filename);\r\n        fd.append('id', this.authUser.id);\r\n        this.subscriptions.push(this.usersService.changeProfileImage(fd).subscribe((dt) => {\r\n            this.changeAuthUserInfo(dt);\r\n        }));\r\n    }\r\n\r\n    coverCropped(event: CroppedEvent) {\r\n        this.coverBase64 = event.base64;\r\n        this.changingImage = true;\r\n        const fd = new FormData();\r\n        const filename = `cover_${Date.now()}.jpg`;\r\n        this.channelForm.patchValue({cover: filename});\r\n        fd.append('cover_file', this.base64ToFile.transform(event.base64), filename);\r\n        fd.append('cover', filename);\r\n        fd.append('id', this.authUser.id);\r\n        this.loader.dataLoading = true;\r\n        this.subscriptions.push(this.usersService.changeCoverImage(fd).subscribe((dt) => {\r\n            this.changeAuthUserInfo(dt);\r\n        }));\r\n    }\r\n\r\n    removeCover() {\r\n        this.channelUser.channel.cover = '';\r\n        this.channelForm.patchValue({cover: this.channelUser.channel.cover});\r\n    }\r\n\r\n    removeAvatar() {\r\n        this.channelUser.channel.avatar = '';\r\n        this.channelForm.patchValue({avatar: this.channelUser.channel.avatar});\r\n    }\r\n\r\n    subscribeToChannel(channel): void {\r\n        this.subscriptions.push(this.channelService.subscribeToChannel({\r\n            user_id: this.authUser.id,\r\n            channel_id: channel.id\r\n        }).subscribe(dt => {\r\n            this.subscribedToChannel = dt.status === 'Subscribed';\r\n            this.subscribersCount = dt.subscribers_count;\r\n            this.subscriptions.push(this.channelService.getUserChannelSubscriptions({user_id: this.authUser.id}).subscribe(d => {\r\n                this.subject.setUserSubscriptions(d);\r\n            }));\r\n        }));\r\n    }\r\n\r\n    checkChannelSubscription() {\r\n        // console.log(this.channelUser)\r\n        this.subscriptions.push(this.channelService.checkChannelSubscription({\r\n            user_id: this.authUser.id,\r\n            channel_id: this.channelUser.channel.id\r\n        }).subscribe(dt => {\r\n            this.subscribedToChannel = dt.status === 'Subscribed';\r\n            this.subscribersCount = dt.subscribers_count;\r\n        }));\r\n    }\r\n\r\n    changeAuthUserInfo(dt) {\r\n        localStorage.setItem('token', dt.token);\r\n        this.authUser = this.getAuthUser.transform();\r\n        this.channelUser = this.authUser;\r\n        this.changingImage = false;\r\n\r\n        const token = dt.hasOwnProperty('token') ? dt?.token : '';\r\n        if (token) {\r\n            localStorage.setItem('token', token);\r\n            this.userStore.setAuthUser(token);\r\n        }\r\n\r\n\r\n        // this.loader.dataLoading = false;\r\n        // console.log(this.channelUser)\r\n    }\r\n\r\n    toggleEditMode() {\r\n        this.editMode = !this.editMode;\r\n    }\r\n\r\n\r\n    saveChanges() {\r\n        console.log('save changes!!!')\r\n        console.log(this.channelForm.value)\r\n        console.log('save changes!!!')\r\n\r\n        if (this.channelForm.valid) {\r\n            this.subscriptions.push(this.channelService.changeChannelDetails(this.channelForm.value).subscribe((dt => {\r\n                this.editMode = false;\r\n                this.changeAuthUserInfo(dt);\r\n            })));\r\n        }\r\n    }\r\n\r\n    toggleBottomChatBox() {\r\n        const foundUserMessages = this.usersConnectionsStore.usersMessages.find(um => um.id === this.channelUser.id);\r\n        if (foundUserMessages) {\r\n            this.usersConnectionsStore.showBottomChatBox = true;\r\n            this.groupsMessagesStore.showBottomChatBox = false;\r\n            this.usersConnectionsStore.changeUser(foundUserMessages);\r\n        }\r\n    }\r\n\r\n    connectWithUser() {\r\n        this.attemptedToConnect = true;\r\n        this.usersConnectionStatus = 'pending';\r\n        this.socketService.connectWithUser({\r\n            from_user: this.authUser,\r\n            to_user: this.channelUser,\r\n            msg: `<strong>${this.authUser.first_name + ' ' + this.authUser.last_name}</strong>\r\n                has sent a connection request to you`\r\n        });\r\n    }\r\n\r\n    getConnectWithUser() {\r\n        this.socketService.getConnectWithUser().subscribe((dt: any) => {\r\n            this.usersConnection = dt.connection;\r\n        });\r\n    }\r\n\r\n    cancelUsersConnecting(connection) {\r\n        this.socketService.cancelUsersConnecting({\r\n            authUser: this.authUser,\r\n            channelUser: this.channelUser,\r\n            connection_id: connection.id\r\n        });\r\n    }\r\n\r\n    cancelledUsersConnecting() {\r\n        this.socketService.cancelledUsersConnecting().subscribe(dt => {\r\n            console.log(dt, 'cancelled')\r\n            this.usersConnectionStatus = 'idle';\r\n        });\r\n    }\r\n\r\n\r\n    disconnectUser() {\r\n        // console.log(this.usersConnection)\r\n        this.socketService.disconnectUsers({\r\n            to_user: this.channelUser,\r\n            from_user: this.authUser,\r\n            connection_id: this.usersConnection.id,\r\n            msg: `<strong>${this.authUser.first_name} ${this.authUser.last_name}</strong> has broken the connection between you two`,\r\n        });\r\n        this.usersConnectionStatus = 'idle';\r\n    }\r\n\r\n    getDisconnectUsers() {\r\n        this.subscriptions.push(this.socketService.getDisconnectUsers().subscribe(dt => {\r\n            this.usersConnectionStatus = 'idle';\r\n        }));\r\n    }\r\n\r\n    getBlockUnblockUser() {\r\n        this.subscriptions.push(this.socketService.getBlockUnblockUser().subscribe((dt: any) => {\r\n            console.log('get block/unblock', dt)\r\n            this.isBlocked = true;\r\n        }));\r\n    }\r\n\r\n    isMessageBtnShown() {\r\n        return /connected|test/.test(this.usersConnectionStatus) && !this.isBlocked;\r\n    }\r\n\r\n\r\n    ngOnDestroy(): void {\r\n        this.subscriptions.forEach(s => s.unsubscribe());\r\n    }\r\n\r\n}\r\n","<div class=\"about-tab\">\r\n\r\n\r\n    <div class=\"info\">\r\n        <h2 *ngIf=\"channelUser.channel?.description\">Description</h2>\r\n\r\n        <div class=\"date\">\r\n            <span>Joined {{channelUser.channel.created_at|date: 'd MMM, yyyy'}}</span>\r\n            <button class=\"btn\" (click)=\"editModeOn()\"\r\n                    *ngIf=\"!editMode && authUser.username === channelUser.username\">Edit\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"description\" [hidden]=\"editMode\">\r\n        <p>{{channelUser.channel.description}}</p>\r\n    </div>\r\n\r\n    <div class=\"edit-form-controls\" [hidden]=\"!editMode\">\r\n        <form [formGroup]=\"aboutForm\" id=\"channel-about-form\">\r\n            <textarea rows=\"15\" formControlName=\"description\"></textarea>\r\n\r\n            <button class=\"save\" (click)=\"saveChannelDescription()\">Save</button>\r\n\r\n            <mat-error *ngIf=\"aboutForm.get('description').hasError('maxlength')\">\r\n                Not more than 100 characters please\r\n            </mat-error>\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n","import {AfterViewInit, Component, Input, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {ChannelsService} from '@core/services/channels.service';\r\nimport {GetAuthUserPipe} from '@shared/pipes/get-auth-user.pipe';\r\nimport {DESCRIPTION_CHARACTERS_LIMIT} from '@core/constants/global';\r\nimport {FixTextLineBreaksPipe} from '@shared/pipes/fix-text-line-breaks.pipe';\r\n\r\n@Component({\r\n    selector: 'app-about-tab',\r\n    templateUrl: './about-tab.component.html',\r\n    styleUrls: ['./about-tab.component.scss']\r\n})\r\nexport class AboutTabComponent implements OnInit, AfterViewInit {\r\n    aboutForm: FormGroup;\r\n    editMode = false;\r\n    authUser;\r\n    @Input('channelUser') channelUser;\r\n\r\n    constructor(\r\n        private fb: FormBuilder,\r\n        private channelService: ChannelsService,\r\n        private getAuthUser: GetAuthUserPipe,\r\n        private fixLineBreaks: FixTextLineBreaksPipe\r\n    ) {\r\n        this.authUser = this.getAuthUser.transform();\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.aboutForm = this.fb.group({\r\n                description: ['', [Validators.required, Validators.maxLength(DESCRIPTION_CHARACTERS_LIMIT)]],\r\n                id: ['', Validators.required],\r\n                username: ['', Validators.required]\r\n            },\r\n        );\r\n        this.aboutForm.patchValue({\r\n            username: this.channelUser.username,\r\n            id: this.channelUser.channel.id,\r\n            description: this.fixLineBreaks.transform(this.channelUser.channel.description)\r\n            // ...this.channelUser.channel\r\n        });\r\n\r\n    }\r\n\r\n    editModeOn() {\r\n        this.editMode = true;\r\n    }\r\n\r\n    saveChannelDescription() {\r\n        if (this.aboutForm.valid) {\r\n            this.channelService.saveDescription(this.aboutForm.value).subscribe(dt => {\r\n                this.channelUser = dt;\r\n                document.querySelector('.description').innerHTML = this.channelUser.channel.description;\r\n                this.editMode = false;\r\n            });\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        document.querySelector('.description').innerHTML = this.channelUser.channel.description;\r\n    }\r\n\r\n}\r\n","<mat-spinner [diameter]=\"15\" *ngIf=\"loader.channelLoading.status==='loading'\"></mat-spinner>\r\n<div class=\"profile-list\">\r\n    <!--    <app-categories></app-categories>-->\r\n    <ng-container *ngIf=\"channelUser\">\r\n        <app-user-tags *ngIf=\"auth.loggedIn()\" (tagSelected)=\"getVideosByTag($event)\"></app-user-tags>\r\n        <app-channel-profile [channelUser]=\"channelUser\" [authUser]=\"authUser\" *ngIf=\"channelUser\"></app-channel-profile>\r\n        <div class=\"stocks-watchlist pWatchlist\">\r\n            <div class=\"profile-list user-profile-block\">\r\n                <ul class=\"nav nav-tabs\" id=\"channel-tabs-list\" role=\"tablist\">\r\n                    <li class=\"nav-item\" *ngFor=\"let tab of allTabs;trackBy:trackByElement\">\r\n                        <a class=\"nav-link\" [class.active]=\"tab === activeTab\" id=\"{{tab.link}}-tab\"\r\n                           (click)=\"changeActiveTab(tab)\" data-toggle=\"tab\" [href]=\"'#'+tab.link\" role=\"tab\"\r\n                           aria-controls=\"pWatch\"\r\n                           aria-selected=\"true\">{{tab.name}}</a>\r\n                    </li>\r\n                </ul>\r\n\r\n                <div class=\"loader-wrapper\">\r\n                    <div class=\"spinner-container\">\r\n                        <mat-spinner [diameter]=\"15\"\r\n                                     *ngIf=\"loader.stocksLoading.status==='loading'&& activeTab.name==='watchlist'\"></mat-spinner>\r\n                    </div>\r\n                </div>\r\n                <div class=\"search-wrapper\" >\r\n                    <div class=\"left-side\" *ngIf=\"activeTab.name==='Videos'\">\r\n                        <div class=\"toggle-filters-btn\">\r\n                            <button class=\"filter-toggle-btn\"\r\n                                    *ngIf=\"activeTab.name!=='About' && activeTab.name!=='Watchlist'\" type=\"button\"\r\n                                    [class.filters-active]=\"showFilters\"\r\n                                    (click)=\"toggleFilters()\">\r\n                                <mat-icon>tune</mat-icon>\r\n                            </button>\r\n                        </div>\r\n\r\n                            <app-search-videos-form  class=\"child-inp\" (search)=\"searchVideos($event)\"\r\n                                                    *ngIf=\"activeTab.name!=='About' && activeTab.name!=='Watchlist'\"></app-search-videos-form>\r\n\r\n                    </div>\r\n                    <div class=\"right-side\" *ngIf=\"activeTab.name==='Watchlist'\">\r\n\r\n                        <div class=\"open-add-stock-modal\" *ngIf=\"activeTab.name==='Watchlist'\" (click)=\"openModal()\">\r\n                            <button type=\"button\">\r\n                                <mat-icon>add_circle_outline</mat-icon>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div class=\"watchlist-search d-\" *ngIf=\"activeTab.name!=='About'\" [class.bordered]=\"userStocks?.length > 0\">\r\n                            <app-search-stocks-form  class =\"d-block search-stocks-component\" *ngIf=\"activeTab.name==='Watchlist' && userStocks?.length > 0\"\r\n                                                    [whiteForm]=\"true\" [returnSearchText]=\"true\"\r\n                                                    (search)=\"searchInUserStocks($event)\">\r\n                            </app-search-stocks-form>\r\n\r\n                        </div>\r\n\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <app-watchlist-tab *ngIf=\"activeTab.name === 'Watchlist'\" [channelUser]=\"channelUser\"></app-watchlist-tab>\r\n            <app-videos-tab *ngIf=\"activeTab.name === 'Videos'\" [channelUser]=\"channelUser\"\r\n                            [authUser]=\"authUser\"></app-videos-tab>\r\n            <app-playlists-tab *ngIf=\"activeTab.name === 'Playlists'\" [channelUser]=\"channelUser\"\r\n                               [authUser]=\"authUser\"></app-playlists-tab>\r\n            <app-about-tab *ngIf=\"activeTab.name === 'About'\" [channelUser]=\"channelUser\"></app-about-tab>\r\n        </div>\r\n    </ng-container>\r\n    <div class=\"channel-not-found\" *ngIf=\"!channelUser && loader.channelLoading.status==='finished'\">\r\n        <p>Channel with such name is not found</p>\r\n    </div>\r\n</div>\r\n\r\n<!--<app-chat-bottom-box *ngIf=\"usersMessagesStore.showBottomChatBox && channelUser\" [channelUser]=\"channelUser\"-->\r\n<!--                     ></app-chat-bottom-box>-->\r\n","import {NgModule} from '@angular/core';\r\nimport {Routes, RouterModule} from '@angular/router';\r\nimport {ShowChannelComponent} from '@app/channels/show-channel/show-channel.component';\r\n\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: 'show',\r\n        component: ShowChannelComponent,\r\n        data: {\r\n            title: 'Channel page'\r\n        }\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class ChannelsRoutingModule {\r\n}\r\n","import {Component, OnDestroy, OnInit, TemplateRef, ViewChild} from '@angular/core';\r\nimport {API_URL, PROFILE_PAGE_TABS} from '@core/constants/global';\r\nimport {User} from '@shared/models/user';\r\nimport {VideoService} from '@core/services/video.service';\r\nimport {GetAuthUserPipe} from '@shared/pipes/get-auth-user.pipe';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {UsersService} from '@core/services/users.service';\r\nimport {Base64ToFilePipe} from '@shared/pipes/base64-to-file.pipe';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {ChannelsService} from '@core/services/channels.service';\r\nimport {SubjectService} from '@core/services/subject.service';\r\nimport {MatDialog} from '@angular/material/dialog';\r\nimport {PlaylistsService} from '@core/services/playlists.service';\r\nimport {WatchlistTabComponent} from '@app/channels/show-channel/watchlist-tab/watchlist-tab.component';\r\nimport {VideosTabComponent} from '@app/channels/show-channel/videos-tab/videos-tab.component';\r\nimport {PlaylistsTabComponent} from '@app/channels/show-channel/playlists-tab/playlists-tab.component';\r\nimport {AuthService} from '@core/services/auth.service';\r\nimport {StocksListsModalComponent} from '@shared/components/stocks-lists-modal/stocks-lists-modal.component';\r\nimport {LoaderService} from '@core/services/loader.service';\r\nimport {UpdateUserStocksPipe} from '@shared/pipes/update-user-stocks.pipe';\r\nimport {StocksService} from '@core/services/stocks.service';\r\nimport {ToastrService} from 'ngx-toastr';\r\nimport trackByElement from '@core/helpers/track-by-element';\r\nimport {ChatService} from '@core/services/chat.service';\r\nimport {UsersMessagesSubjectService} from '@core/services/stores/users-messages-subject.service';\r\n\r\n@Component({\r\n    selector: 'app-show-channel',\r\n    templateUrl: './show-channel.component.html',\r\n    styleUrls: ['./show-channel.component.scss']\r\n})\r\nexport class ShowChannelComponent implements OnInit, OnDestroy {\r\n\r\n    authUser;\r\n\r\n    activeTab;\r\n    allTabs = PROFILE_PAGE_TABS;\r\n\r\n    apiUrl = API_URL;\r\n\r\n\r\n    channelUser;\r\n    passedUsername;\r\n    passedTab;\r\n\r\n    searchVideosForm: FormGroup;\r\n\r\n\r\n    playlists = [];\r\n    editMode = false;\r\n\r\n    showFilters = false;\r\n    filters = null;\r\n\r\n    dataLoading = 'idle';\r\n\r\n    userStocks = [];\r\n    filteredStocks = [];\r\n    subscriptions = [];\r\n    trackByElement = trackByElement;\r\n\r\n    showChatBox = false;\r\n\r\n\r\n    @ViewChild(WatchlistTabComponent) watchListTab: WatchlistTabComponent;\r\n    @ViewChild(VideosTabComponent) videosTab: VideosTabComponent;\r\n    @ViewChild(PlaylistsTabComponent) playlistsTab: PlaylistsTabComponent;\r\n\r\n    constructor(\r\n        private videoService: VideoService,\r\n        private getAuthUser: GetAuthUserPipe,\r\n        public router: Router,\r\n        private usersService: UsersService,\r\n        private base64ToFile: Base64ToFilePipe,\r\n        private route: ActivatedRoute,\r\n        private fb: FormBuilder,\r\n        private subjectService: SubjectService,\r\n        private channelService: ChannelsService,\r\n        private playlistsService: PlaylistsService,\r\n        private subject: SubjectService,\r\n        public auth: AuthService,\r\n        private dialog: MatDialog,\r\n        public loader: LoaderService,\r\n        private updateStocks: UpdateUserStocksPipe,\r\n        private stocksService: StocksService,\r\n        public usersMessagesStore: UsersMessagesSubjectService,\r\n        private toastr: ToastrService,\r\n        private chatService: ChatService\r\n    ) {\r\n        this.authUser = this.getAuthUser.transform();\r\n        this.passedUsername = this.route.snapshot.queryParams.username;\r\n        this.passedTab = this.route.snapshot.queryParams.tab;\r\n        this.searchVideosForm = this.fb.group({search: ['', Validators.required]});\r\n\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        // localStorage.setItem('search', '');\r\n        this.activeTab = PROFILE_PAGE_TABS.filter(tabs => tabs.name.toLowerCase() === this.passedTab)?.[0] || PROFILE_PAGE_TABS[0];\r\n        this.getUserInfo();\r\n\r\n        this.subject.currentUserStocks.subscribe((dt: any) => {\r\n            this.userStocks = dt.stocks;\r\n            this.filteredStocks = this.userStocks;\r\n        });\r\n    }\r\n\r\n    toggleFilters() {\r\n        this.showFilters = !this.showFilters;\r\n        this.subject.setToggleFiltersData(this.showFilters);\r\n    }\r\n\r\n    getUserInfo() {\r\n        this.loader.channelLoading.status = 'loading';\r\n        const viewingOwnChannel = +(this.authUser.username === this.passedUsername);\r\n        if (this.passedUsername) {\r\n            this.usersService.getUserInfo({\r\n                username: this.passedUsername,\r\n                own_channel: viewingOwnChannel\r\n            }).subscribe(dt => {\r\n                if (dt) {\r\n                    this.channelUser = dt;\r\n                }\r\n                this.loader.channelLoading.status = 'finished';\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    async changeActiveTab(tab) {\r\n        this.activeTab = tab;\r\n        this.showFilters = false;\r\n        await this.router.navigate([`/channels/show`], {\r\n            queryParams: {\r\n                tab: tab.name.toLowerCase(),\r\n                username: this.passedUsername\r\n            }\r\n        });\r\n        this.subject.setToggleFiltersData(this.showFilters);\r\n        if (this.activeTab.name === 'Videos') {\r\n            this.getUserInfo();\r\n        }\r\n    }\r\n\r\n    searchInUserStocks(e) {\r\n        localStorage.setItem('searchStock', e.search);\r\n        this.watchListTab.getSearchResults(e);\r\n    }\r\n\r\n    searchVideos(e?) {\r\n        localStorage.setItem('search', e.search);\r\n        this.showFilters = false;\r\n        this.subject.setToggleFiltersData(this.showFilters);\r\n        if (this.activeTab.name === 'Videos') {\r\n            this.searchInUserVideos(e.search);\r\n        } else if (this.activeTab.name === 'Playlists') {\r\n            this.searchInPlaylists(e.search);\r\n        }\r\n\r\n    }\r\n\r\n    searchInVideosByAuthor(s) {\r\n        if (this.watchListTab) {\r\n            // this.watchListTab.getSearchResults(s);\r\n        }\r\n\r\n    }\r\n\r\n    searchInUserVideos(s) {\r\n        if (this.videosTab) {\r\n            this.videosTab.getSearchResults(s);\r\n        }\r\n    }\r\n\r\n    searchInPlaylists(s) {\r\n        if (this.playlistsTab) {\r\n            this.playlistsTab.getSearchResults(s);\r\n        }\r\n    }\r\n\r\n\r\n    async getVideosByTag(name) {\r\n        await this.router.navigate(['videos'], {queryParams: {tag: name}});\r\n    }\r\n\r\n    openModal() {\r\n        this.dialog.open(StocksListsModalComponent, {\r\n            maxWidth: '100vw',\r\n            maxHeight: '100vh',\r\n            height: '100%',\r\n            width: '100%',\r\n            panelClass: 'stocks-lists-modal'\r\n        }).afterClosed().subscribe(dt => {\r\n        });\r\n    }\r\n\r\n    isStockFollowed(stock) {\r\n        return !!this.userStocks.find(s => s.name === stock.name);\r\n    }\r\n\r\n    updateFollowedStocksList(stock) {\r\n        const result = this.updateStocks.transform(this.userStocks, stock, this.isStockFollowed(stock));\r\n        if (result) {\r\n            this.loader.stocksLoading.status = 'loading';\r\n            this.subscriptions.push(this.stocksService.updateFollowedStocks(\r\n                {user_id: this.authUser.id, ...{stocks: result}})\r\n                .subscribe(dt => {\r\n                    this.userStocks = dt?.user_stocks || [];\r\n                    this.loader.stocksLoading.status = 'finished';\r\n                    this.subject.changeUserStocks({stocks: this.userStocks, empty: this.userStocks.length === 0});\r\n                }));\r\n        }\r\n\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.subscriptions.forEach(s => s.unsubscribe());\r\n    }\r\n\r\n\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\n\r\nimport {ChannelsRoutingModule} from './channels-routing.module';\r\nimport {ShowChannelComponent} from './show-channel/show-channel.component';\r\nimport {SharedModule} from '@shared/shared.module';\r\nimport {NgxPhotoEditorModule} from 'ngx-photo-editor';\r\nimport {ChannelProfileComponent} from './show-channel/channel-profile/channel-profile.component';\r\nimport {WatchlistTabComponent} from './show-channel/watchlist-tab/watchlist-tab.component';\r\nimport {VideosTabComponent} from './show-channel/videos-tab/videos-tab.component';\r\nimport {PlaylistsTabComponent} from './show-channel/playlists-tab/playlists-tab.component';\r\nimport {AboutTabComponent} from './show-channel/about-tab/about-tab.component';\r\n\r\n\r\n@NgModule({\r\n    declarations: [\r\n        ShowChannelComponent,\r\n        ChannelProfileComponent,\r\n        WatchlistTabComponent,\r\n        VideosTabComponent,\r\n        PlaylistsTabComponent,\r\n        AboutTabComponent\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        ChannelsRoutingModule,\r\n        SharedModule,\r\n        NgxPhotoEditorModule,\r\n    ]\r\n})\r\nexport class ChannelsModule {\r\n}\r\n"]}